---
// src/pages/[lang]/[page].astro
import BaseLayout from "@/layouts/BaseLayout.astro";
import { getCollection, render } from "astro:content";
import type { Locale } from "@/i18n/config";

// Build static paths for every localized "otherPages" entry
export async function getStaticPaths() {
  const entries = await getCollection("otherPages");
  return entries
    .filter((entry) => {
      const fmLang = (entry.data as any).lang as string | undefined;
      const raw = String(entry.slug ?? entry.id);
      return fmLang === "el" || raw.startsWith("el/");
    })
    .map((entry) => {
      const raw = String(entry.slug ?? entry.id);
      const page = raw.replace(/^en\/|^el\//, "");
      return { params: { page }, props: { entry, lang: "el" as Locale } };
    });
}

const { entry, lang } = Astro.props as { entry: any; lang: Locale };
const { title, description } = entry.data;
const { Content } = await render(entry);
---

<BaseLayout title={title} description={description} lang={lang}>
  <article class="site-container py-16">
    <h1 class="h1">{title}</h1>
    <p class="mt-4 opacity-80">{description}</p>
    <div class="prose mt-8">
      <Content />
    </div>
  </article>
</BaseLayout>
