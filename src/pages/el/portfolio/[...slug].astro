---
import PortfolioLayout from "@/layouts/PortfolioLayout.astro";
import { getCollection, getEntry, render } from "astro:content";

export async function getStaticPaths() {
  const entries = await getCollection("portfolios");

  return entries
    .filter((e) => {
      const fmLang = (e.data as any).lang as string | undefined;
      const raw = String(e.slug ?? e.id);
      return fmLang === "el" || raw.startsWith("el/");
    })
    .map((entry) => {
      const raw = String(entry.slug ?? entry.id);
      const rest = raw.replace(/^en\/|^el\//, "").replace(/\/index$/, "");
      return { params: { slug: rest }, props: { entryId: entry.id } };
    });
}

const { entryId } = Astro.props as { entryId: string };
const entry = await getEntry("portfolios", entryId);
const { Content } = await render(entry!);
---

<PortfolioLayout portfolio={entry as any}>
  <Content />
</PortfolioLayout>
